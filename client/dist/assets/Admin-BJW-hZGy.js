import{j as e,a as S,e as w,r as z,w as H,b as q}from"./index-DWLRf4Io.js";import{r,g as G,e as Y,u as K,R as X,c as B,N as J}from"./vendor-NZU9o91k.js";import{j as O,k as Q,a as Z,I as ee,F as se,Y as te,l as ie,m as ne,E as re,B as ae,n as le,o as oe,p as de,q as ce,r as he,s as xe,t as me,u as ue,v as fe,X as pe,M as ge}from"./icons-BGCQDtub.js";function je(){const[a,d]=r.useState("general"),[i,c]=r.useState("neutral"),x=r.useMemo(()=>[{key:"neutral",name:"Neutral",tones:["#111","#333","#888","#e0e0e0","#fff"]},{key:"dim",name:"Dim",tones:["#111","#222","#555","#cfcfcf","#f6f6f6"]},{key:"contrast",name:"High Contrast",tones:["#000","#111","#666","#dddddd","#ffffff"]},{key:"mono",name:"Mono",tones:["#111","#444","#777","#bbbbbb","#f2f2f2"]}],[]),p=[{key:"general",label:"General"},{key:"appearance",label:"Appearance"},{key:"security",label:"Security"},{key:"email",label:"Email"}];return e.jsxs("div",{style:{display:"grid",gap:"1rem"},children:[e.jsxs("div",{className:"traffic-toolbar",children:[e.jsx("div",{className:"toolbar-top",children:e.jsx("div",{className:"title",children:"Settings"})}),e.jsx("div",{className:"traffic-chip-row",children:p.map(s=>e.jsx("button",{type:"button",className:`traffic-chip ${a===s.key?"active":""}`,onClick:()=>d(s.key),children:s.label},s.key))})]}),e.jsxs("div",{style:{background:"#fff",border:"1px solid #d0d0d0",borderRadius:12,padding:"1.5rem",boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[a==="general"&&e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("h2",{style:{fontSize:20,fontWeight:800,margin:0,marginBottom:4},children:"General Settings"}),e.jsx("p",{style:{fontSize:13,color:"#666",margin:0},children:"Basic configuration for your site"})]}),e.jsxs("div",{style:{display:"grid",gap:"1.25rem",maxWidth:600},children:[e.jsx(T,{label:"Site Title",children:e.jsx("input",{type:"text",placeholder:"PeakSelf",style:D})}),e.jsx(T,{label:"Support Email",children:e.jsx("input",{type:"email",placeholder:"support@example.com",style:D})}),e.jsx(T,{label:"Tagline",children:e.jsx("textarea",{rows:3,placeholder:"A short description of your site",style:D})}),e.jsx(T,{label:"Maintenance Mode",description:"Enable this to show a maintenance page to visitors",children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",style:{width:18,height:18}}),e.jsx("span",{style:{fontSize:13},children:"Enable maintenance mode"})]})})]})]}),a==="appearance"&&e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("h2",{style:{fontSize:20,fontWeight:800,margin:0,marginBottom:4},children:"Appearance"}),e.jsx("p",{style:{fontSize:13,color:"#666",margin:0},children:"Customize the look and feel"})]}),e.jsxs("div",{style:{display:"grid",gap:"1.5rem",maxWidth:600},children:[e.jsx(T,{label:"Theme",description:"Choose between light, dark, or auto mode",children:e.jsx("div",{style:{display:"flex",gap:12},children:["Light","Auto","Dark"].map(s=>e.jsxs("label",{style:{flex:1,padding:"12px",border:"2px solid #d0d0d0",borderRadius:8,cursor:"pointer",textAlign:"center",fontSize:13,fontWeight:600,transition:"all 0.2s ease",background:s==="Light"?"#111":"#fff",color:s==="Light"?"#fff":"#111"},children:[e.jsx("input",{type:"radio",name:"theme",defaultChecked:s==="Light",style:{display:"none"}}),s]},s))})}),e.jsx(T,{label:"Color Palette",description:"Select your preferred color scheme",children:e.jsx("div",{style:{display:"grid",gap:12},children:x.map(s=>e.jsxs("button",{type:"button",onClick:()=>c(s.key),style:{padding:"12px 16px",border:i===s.key?"2px solid #111":"1px solid #d0d0d0",borderRadius:8,background:"#fff",cursor:"pointer",textAlign:"left",display:"flex",alignItems:"center",justifyContent:"space-between",transition:"all 0.2s ease"},children:[e.jsx("span",{style:{fontWeight:600,fontSize:14},children:s.name}),e.jsx("div",{style:{display:"flex",gap:4},children:s.tones.map((k,m)=>e.jsx("div",{style:{width:20,height:20,background:k,borderRadius:4,border:"1px solid #ddd"}},m))})]},s.key))})})]})]}),a==="security"&&e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("h2",{style:{fontSize:20,fontWeight:800,margin:0,marginBottom:4},children:"Security"}),e.jsx("p",{style:{fontSize:13,color:"#666",margin:0},children:"Authentication and session options"})]}),e.jsxs("div",{style:{display:"grid",gap:"1.25rem",maxWidth:600},children:[e.jsx(T,{label:"JWT Expiry",description:"Number of days before tokens expire",children:e.jsx("input",{type:"number",min:1,max:30,defaultValue:1,style:D})}),e.jsx(T,{label:"Two-Factor Authentication",children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",style:{width:18,height:18}}),e.jsx("span",{style:{fontSize:13},children:"Require 2FA for all users"})]})}),e.jsx(T,{label:"Email Login",children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",defaultChecked:!0,style:{width:18,height:18}}),e.jsx("span",{style:{fontSize:13},children:"Allow login with email and password"})]})})]})]}),a==="email"&&e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("h2",{style:{fontSize:20,fontWeight:800,margin:0,marginBottom:4},children:"Email Configuration"}),e.jsx("p",{style:{fontSize:13,color:"#666",margin:0},children:"Configure email settings and SMTP"})]}),e.jsxs("div",{style:{display:"grid",gap:"1.25rem",maxWidth:600},children:[e.jsx(T,{label:"From Name",children:e.jsx("input",{type:"text",placeholder:"PeakSelf",style:D})}),e.jsx(T,{label:"From Address",children:e.jsx("input",{type:"email",placeholder:"no-reply@example.com",style:D})}),e.jsx(T,{label:"SMTP Configuration",children:e.jsxs("div",{style:{padding:"12px 16px",background:"#f6f6f6",border:"1px solid #d0d0d0",borderRadius:8,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:13,fontWeight:600,marginBottom:2},children:"Status"}),e.jsx("div",{style:{fontSize:12,color:"#666"},children:"Not configured"})]}),e.jsx("button",{className:"btn small",type:"button",children:"Configure"})]})})]})]}),e.jsxs("div",{style:{marginTop:"2rem",paddingTop:"1.5rem",borderTop:"1px solid #e0e0e0",display:"flex",gap:12,justifyContent:"flex-end"},children:[e.jsx("button",{className:"btn secondary",type:"button",children:"Reset Changes"}),e.jsx("button",{className:"btn primary",type:"button",children:"Save Changes"})]})]})]})}const D={width:"100%",padding:"10px 12px",border:"1px solid #d0d0d0",borderRadius:8,fontSize:14,background:"#fff",fontFamily:"inherit",transition:"border-color 0.2s ease",outline:"none"};function T({label:a,description:d,children:i}){return e.jsxs("div",{style:{display:"grid",gap:6},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:13,fontWeight:700,color:"#111",marginBottom:2},children:a}),d&&e.jsx("div",{style:{fontSize:12,color:"#888"},children:d})]}),e.jsx("div",{children:i})]})}const V=({cards:a=8,type:d="stat"})=>{const i={backgroundColor:"#f0f0f0",borderRadius:"8px",animation:"pulse 1.5s ease-in-out infinite"};return d==="content"?e.jsx("div",{className:"card-grid",children:Array.from({length:a}).map((c,x)=>e.jsxs("div",{className:"content-card",style:{minHeight:"150px"},children:[e.jsx("div",{style:{...i,height:"24px",width:"80%",marginBottom:"12px"}}),e.jsx("div",{style:{...i,height:"16px",width:"100%",marginBottom:"8px"}}),e.jsx("div",{style:{...i,height:"16px",width:"90%",marginBottom:"16px"}}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsx("div",{style:{...i,height:"32px",width:"60px"}}),e.jsx("div",{style:{...i,height:"32px",width:"70px"}}),e.jsx("div",{style:{...i,height:"32px",width:"60px"}})]})]},x))}):e.jsx("div",{className:"card-grid",children:Array.from({length:a}).map((c,x)=>e.jsxs("div",{style:{border:"1px solid #d0d0d0",borderRadius:12,padding:"1.25rem",background:"#fff",boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[e.jsx("div",{style:{...i,width:"60%",height:"14px"}}),e.jsx("div",{style:{...i,width:"20px",height:"20px",borderRadius:"50%"}})]}),e.jsx("div",{style:{...i,height:"28px",width:"50%",marginBottom:"8px"}}),e.jsx("div",{style:{...i,height:"12px",width:"40%"}})]},x))})};function ve(){const[a,d]=r.useState(!0),[i,c]=r.useState(""),[x,p]=r.useState(null);if(r.useEffect(()=>{let m=!1;async function u(){try{const{data:h}=await S.get(w.admin.overview);m||p(h)}catch(h){m||c(z.getErrorMessage(h))}finally{m||d(!1)}}return u(),()=>{m=!0}},[]),a)return e.jsxs("div",{className:"admin-content",children:[e.jsx("div",{className:"traffic-toolbar",children:e.jsx("div",{className:"toolbar-top",children:e.jsx("div",{className:"title",children:"Overview"})})}),e.jsx(V,{cards:8,type:"stat"})]});if(i)return e.jsxs("div",{style:{padding:"1rem",color:"#b91c1c"},children:["Error: ",i]});const s=x||{},k=s.snapshot_at?new Date(s.snapshot_at).toLocaleString():s.source==="live"?"live":"";return e.jsxs("div",{className:"admin-content",children:[e.jsxs("div",{className:"traffic-toolbar",children:[e.jsx("div",{className:"toolbar-top",children:e.jsx("div",{className:"title",children:"Overview"})}),e.jsx("div",{className:"traffic-chip-row",children:e.jsxs("div",{style:{fontSize:12,color:"#666"},children:["Source: ",s.source||"snapshot"," ",k&&`• ${k}`]})})]}),e.jsxs("div",{className:"card-grid",children:[e.jsx(I,{icon:O,title:"Total Users",value:E(s.total_users),subtitle:s.signups_24h!=null?`+${E(s.signups_24h)} / 24h`:""}),e.jsx(I,{icon:Q,title:"Verified Users",value:E(s.verified_users),subtitle:""}),e.jsx(I,{icon:Z,title:"Newsletter Subs",value:E(s.newsletter_total),subtitle:s.newsletter_signups_24h!=null?`+${E(s.newsletter_signups_24h)} / 24h`:""}),e.jsx(I,{icon:ee,title:"Sessions • Instagram",value:E(s.sessions_instagram),subtitle:"last 7 days",color:"#E4405F"}),e.jsx(I,{icon:se,title:"Sessions • Facebook",value:E(s.sessions_facebook),subtitle:"last 7 days",color:"#1877F2"}),e.jsx(I,{icon:te,title:"Sessions • YouTube",value:E(s.sessions_youtube),subtitle:"last 7 days",color:"#FF0000"}),e.jsx(I,{icon:ye,title:"Sessions • Google",value:E(s.sessions_google),subtitle:"last 7 days",color:"#4285F4"}),e.jsx(I,{icon:ie,title:"Sessions • Others",value:E(s.sessions_others),subtitle:"last 7 days",color:"#6366F1"})]}),Array.isArray(s.sessions_others_refs)&&s.sessions_others_refs.length>0&&e.jsxs("div",{style:{border:"1px solid #d0d0d0",borderRadius:12,padding:"1.5rem",background:"#fff",boxShadow:"0 1px 3px rgba(0,0,0,0.08)",marginTop:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid #e5e5e5"},children:[e.jsx(ne,{size:18,style:{color:"#000"}}),e.jsx("h3",{style:{fontSize:16,fontWeight:800,color:"#000",margin:0},children:'Top "Others" Referrers'}),e.jsx("span",{style:{fontSize:11,color:"#666",marginLeft:"auto",textTransform:"uppercase",fontWeight:700,letterSpacing:"0.5px"},children:"Last 7 Days"})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:s.sessions_others_refs.map((m,u)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"0.75rem",background:"#fff",borderRadius:8,border:"1px solid #ddd",transition:"all 0.2s ease"},onMouseEnter:h=>{h.currentTarget.style.background="#f5f5f5",h.currentTarget.style.borderColor="#999";const y=h.currentTarget.querySelector(".rank-badge"),N=h.currentTarget.querySelector(".link-icon"),g=h.currentTarget.querySelector(".ref-text");y&&(y.style.background="#333"),N&&(N.style.color="#000"),g&&(g.style.color="#000")},onMouseLeave:h=>{h.currentTarget.style.background="#fff",h.currentTarget.style.borderColor="#ddd";const y=h.currentTarget.querySelector(".rank-badge"),N=h.currentTarget.querySelector(".link-icon"),g=h.currentTarget.querySelector(".ref-text");y&&(y.style.background="#000"),y&&(y.style.color="#fff"),N&&(N.style.color="#666"),g&&(g.style.color="#111")},children:[e.jsx("div",{className:"rank-badge",style:{minWidth:24,height:24,borderRadius:"50%",background:"#000",display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:900,color:"#fff",flexShrink:0,transition:"all 0.2s ease"},children:u+1}),e.jsx(re,{className:"link-icon",size:14,style:{color:"#666",flexShrink:0,transition:"all 0.2s ease"}}),e.jsx("span",{className:"ref-text",style:{fontSize:13,color:"#111",fontWeight:600,flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",transition:"all 0.2s ease"},children:String(m)})]},u))})]})]})}function I({icon:a,title:d,value:i,subtitle:c,color:x}){return e.jsxs("div",{style:{border:"1px solid #d0d0d0",borderRadius:12,padding:"1.25rem",background:"#fff",boxShadow:"0 1px 3px rgba(0,0,0,0.08)",transition:"transform 0.2s ease, box-shadow 0.2s ease",cursor:"default"},onMouseEnter:p=>{p.currentTarget.style.transform="translateY(-2px)",p.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.12)"},onMouseLeave:p=>{p.currentTarget.style.transform="translateY(0)",p.currentTarget.style.boxShadow="0 1px 3px rgba(0,0,0,0.08)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[e.jsx("div",{style:{fontSize:11,color:"#666",textTransform:"uppercase",fontWeight:700,letterSpacing:"0.5px"},children:d}),a&&e.jsx(a,{size:20,style:{color:x||"#666",opacity:.7}})]}),e.jsx("div",{style:{fontSize:28,fontWeight:900,color:"#111",lineHeight:1},children:i}),c&&e.jsx("div",{style:{fontSize:12,color:"#888",marginTop:8},children:c})]})}function ye({size:a=20,style:d}){return e.jsxs("svg",{width:a,height:a,viewBox:"0 0 24 24",style:d,children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}function E(a){if(a==null)return"-";try{return Number(a).toLocaleString()}catch{return String(a)}}const be=({rows:a=5,columns:d=5})=>{const i={backgroundColor:"#f0f0f0",borderRadius:"6px",animation:"pulse 1.5s ease-in-out infinite",height:"16px"};return e.jsx("div",{className:"table-wrap",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsx("tr",{children:Array.from({length:d}).map((c,x)=>e.jsx("th",{children:e.jsx("div",{style:{...i,width:"80%",height:"18px"}})},x))})}),e.jsx("tbody",{children:Array.from({length:a}).map((c,x)=>e.jsx("tr",{children:Array.from({length:d}).map((p,s)=>e.jsx("td",{children:e.jsx("div",{style:{...i,width:s===0?"90%":s===d-1?"60%":"70%"}})},s))},x))})]})})};function ke(){const[a,d]=r.useState("all"),[i,c]=r.useState(""),[x,p]=r.useState(!0),[s,k]=r.useState(""),[m,u]=r.useState([]);async function h(){p(!0),k("");try{const t={};i&&(t.q=i),a&&a!=="all"&&(t.filter=a);const{data:v}=await S.get(H(w.admin.users,t));u(Array.isArray(v.users)?v.users:[])}catch(t){k(z.getErrorMessage(t))}finally{p(!1)}}r.useEffect(()=>{h()},[i,a]);const y=async()=>{const t=window.prompt("Enter email to invite:");if(t)try{const{data:v}=await S.post(w.admin.inviteUser,{email:t});alert(v.message||"Invitation sent"),h()}catch(v){alert(z.getErrorMessage(v))}},N=()=>{window.open(w.admin.usersCSV,"_blank")},g=async t=>{try{await S.post(w.admin.makeAdmin(t)),h()}catch(v){alert(z.getErrorMessage(v))}},M=async t=>{try{await S.post(w.admin.removeAdmin(t)),h()}catch(v){alert(z.getErrorMessage(v))}},j=async t=>{if(window.confirm("Are you sure you want to delete this user?"))try{await S.delete(w.admin.userById(t)),h()}catch(v){alert(z.getErrorMessage(v))}};return r.useEffect(()=>{const t=v=>{if((v.ctrlKey||v.metaKey)&&String(v.key).toLowerCase()==="k"){v.preventDefault();const R=document.getElementById("users-search-input");R&&R.focus()}v.key==="Escape"&&c("")};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[]),e.jsxs("div",{className:"admin-users",children:[e.jsxs("div",{className:"traffic-toolbar",children:[e.jsx("div",{className:"toolbar-top",children:e.jsx("div",{className:"title",children:"Users"})}),e.jsx("form",{className:"traffic-search-form",onSubmit:t=>{t.preventDefault(),h()},children:e.jsxs("div",{className:"traffic-search",role:"search",children:[e.jsx("span",{className:"search-icon","aria-hidden":!0,children:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]})}),e.jsx("input",{id:"users-search-input",type:"search",className:"traffic-search-input",placeholder:"Search users by name or email...",value:i,onChange:t=>c(t.target.value),"aria-label":"Search users"}),i&&e.jsx("button",{type:"button",className:"traffic-search-clear","aria-label":"Clear search",title:"Clear",onClick:()=>{c(""),setTimeout(h,0)},children:"×"}),e.jsx("button",{type:"submit",className:"btn primary search-btn",children:"Search"})]})}),e.jsxs("div",{className:"traffic-chip-row",children:[[{key:"all",label:"All"},{key:"admins",label:"Admins"},{key:"unverified",label:"Unverified"}].map(t=>e.jsx("button",{type:"button",onClick:()=>d(t.key),className:`traffic-chip ${a===t.key?"active":""}`,"aria-pressed":a===t.key,children:t.label},t.key)),e.jsx("button",{type:"button",className:"traffic-chip",onClick:y,children:"Invite User"}),e.jsx("button",{type:"button",className:"traffic-chip",onClick:N,children:"Export CSV"})]})]}),x&&e.jsx(be,{rows:8,columns:5}),s&&!x&&e.jsxs("div",{style:{padding:"0.75rem",color:"#b91c1c"},children:["Error: ",s]}),!x&&!s&&e.jsx("div",{className:"table-wrap",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsx("tr",{children:["Name","Email","Role","Verified","Actions"].map(t=>e.jsx("th",{children:t},t))})}),e.jsxs("tbody",{children:[m.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:t.name||"—"}),e.jsx("td",{children:t.email}),e.jsx("td",{children:e.jsx("span",{className:`role ${t.role}`,children:t.role})}),e.jsx("td",{children:t.verified?"Yes":"No"}),e.jsx("td",{children:e.jsxs("div",{className:"row-actions",children:[e.jsx("button",{className:"btn small",onClick:()=>alert(JSON.stringify(t,null,2)),children:"View"}),t.role!=="admin"?e.jsx("button",{className:"btn small",onClick:()=>g(t.id),children:"Make Admin"}):e.jsx("button",{className:"btn small",onClick:()=>M(t.id),children:"Remove Admin"}),e.jsx("button",{className:"btn small danger",onClick:()=>j(t.id),children:"Remove"})]})})]},t.id)),m.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,style:{padding:"1rem",color:"#666"},children:"No users found."})})]})]})})]})}function Ne({onSave:a,onCancel:d,initialPost:i}){const[c,x]=r.useState(i?.title||""),[p,s]=r.useState([]),[k,m]=r.useState(!1),[u,h]=r.useState(""),[y,N]=r.useState(""),g=r.useRef(null),M=r.useRef(null),j=r.useRef(null);G.useEffect(()=>{i?.content&&g.current&&(g.current.innerHTML=i.content)},[i]);const t=f=>{document.execCommand(f,!1,null),g.current.focus()},v=()=>{const f=window.getSelection(),b=f.toString();f.rangeCount>0&&(j.current=f.getRangeAt(0).cloneRange()),b&&h(b),m(!0)},l=()=>{m(!1),y&&setTimeout(()=>{if(g.current.focus(),j.current){const b=window.getSelection();b.removeAllRanges(),b.addRange(j.current)}const f=`<a href="${y}" target="_blank" rel="noopener noreferrer">${u||y}</a>`;document.execCommand("insertHTML",!1,f),j.current=null},0),h(""),N("")},R=async f=>{const b=f.target.files[0];if(console.log("File selected:",b),!b){console.log("No file selected");return}if(!b.type.startsWith("image/")){alert("Please select an image file");return}const C=new FileReader;C.onerror=L=>{console.error("FileReader error:",L),alert("Failed to read image file")},C.onload=async L=>{console.log("File loaded, inserting temp image"),g.current.focus();const _=`<div class="image-wrapper uploading" contenteditable="false" data-temp="true"><img src="${L.target.result}" class="blog-image" alt="Uploading..." /></div>`;document.execCommand("insertHTML",!1,_),console.log("Temp image inserted, starting upload");try{const n=new FormData;n.append("image",b),console.log("Uploading to server...");const{data:o}=await S.upload(w.blog.uploadImage,n);console.log("Upload successful, image URL:",o.url);const A=g.current.querySelector('.image-wrapper[data-temp="true"]');if(A){const $=`<div class="image-wrapper" contenteditable="false"><img src="${o.url}" class="blog-image" alt="Blog image" /></div><p><br></p>`;A.outerHTML=$,console.log("Image inserted successfully")}else console.warn("Could not find temp image wrapper")}catch(n){console.error("Error uploading image:",n);const o=g.current.querySelector('.image-wrapper[data-temp="true"]');o&&o.remove(),alert(`Failed to upload image: ${n.message}`)}setTimeout(()=>{g.current.querySelectorAll(".image-wrapper").forEach(o=>{o.hasAttribute("data-listener")||(o.setAttribute("data-listener","true"),o.addEventListener("click",function(){this.classList.toggle("selected")}))})},0)},C.readAsDataURL(b),f.target.value=""},W=f=>{if(f.key==="Backspace"||f.key==="Delete"){const b=window.getSelection();if(b.rangeCount>0){const C=b.getRangeAt(0),L=C.startContainer;let _=null;if(f.key==="Backspace"){const o=(L.nodeType===3||C.startOffset===0)&&L.previousSibling;o&&o.classList&&o.classList.contains("image-wrapper")&&(_=o)}else if(f.key==="Delete"){const o=L.nodeType===3?L.nextSibling:L.childNodes[C.startOffset];o&&o.classList&&o.classList.contains("image-wrapper")&&(_=o)}const n=g.current.querySelector(".image-wrapper.selected");if(n&&(_=n),_){f.preventDefault(),_.remove();return}}}},P=()=>{const f=g.current.innerHTML;a({title:c,content:f,excerpt:g.current.innerText.substring(0,150)})};return e.jsx("div",{className:"content-editor-overlay",children:e.jsxs("div",{className:"content-editor-modal",children:[e.jsx("div",{className:"editor-header",children:e.jsx("input",{type:"text",placeholder:"Post Title",value:c,onChange:f=>x(f.target.value),className:"title-input"})}),e.jsxs("div",{className:"editor-toolbar",children:[e.jsx("button",{type:"button",onClick:()=>t("bold"),className:"toolbar-btn",title:"Bold",children:e.jsx(ae,{size:18})}),e.jsx("button",{type:"button",onClick:()=>t("italic"),className:"toolbar-btn",title:"Italic",children:e.jsx(le,{size:18})}),e.jsx("button",{type:"button",onClick:()=>t("underline"),className:"toolbar-btn",title:"Underline",children:e.jsx(oe,{size:18})}),e.jsx("div",{className:"toolbar-divider"}),e.jsx("button",{type:"button",onClick:v,className:"toolbar-btn",title:"Insert Link",children:e.jsx(de,{size:18})}),e.jsx("button",{type:"button",onClick:()=>M.current.click(),className:"toolbar-btn",title:"Insert Image",children:e.jsx(ce,{size:18})}),e.jsx("input",{ref:M,type:"file",accept:"image/*",onChange:R,style:{display:"none"}})]}),e.jsx("div",{ref:g,contentEditable:!0,className:"editor-content",onKeyDown:W,suppressContentEditableWarning:!0}),e.jsxs("div",{className:"editor-actions",children:[e.jsx("button",{onClick:d,className:"btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:P,className:"btn-primary",children:"Save Post"})]}),k&&e.jsx("div",{className:"link-modal-overlay",onClick:()=>m(!1),children:e.jsxs("div",{className:"link-modal",onClick:f=>f.stopPropagation(),children:[e.jsx("h3",{children:"Insert Link"}),e.jsx("input",{type:"text",placeholder:"Link text",value:u,onChange:f=>h(f.target.value),className:"link-input"}),e.jsx("input",{type:"url",placeholder:"URL (https://...)",value:y,onChange:f=>N(f.target.value),className:"link-input"}),e.jsxs("div",{className:"link-modal-actions",children:[e.jsx("button",{onClick:()=>m(!1),className:"btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:l,className:"btn-primary",children:"Insert"})]})]})})]})})}function we(){const[a,d]=r.useState(!1),[i,c]=r.useState([]),[x,p]=r.useState(null),[s,k]=r.useState(!0),[m,u]=r.useState("");r.useEffect(()=>{h()},[]);const h=async()=>{try{k(!0);const{data:j}=await S.get(w.admin.blogPosts);c(j.posts)}catch(j){u(z.getErrorMessage(j))}finally{k(!1)}},y=async j=>{try{if(x){const{data:t}=await S.put(w.blog.update(x.id),j);c(i.map(v=>v.id===x.id?t.post:v)),p(null)}else{const{data:t}=await S.post(w.blog.create,j);c([t.post,...i])}d(!1)}catch(t){alert(z.getErrorMessage(t))}},N=j=>{p(j),d(!0)},g=()=>{d(!1),p(null)},M=async j=>{if(confirm("Are you sure you want to delete this post?"))try{await S.delete(w.blog.delete(j)),c(i.filter(t=>t.id!==j))}catch(t){alert(z.getErrorMessage(t))}};return s?e.jsxs("div",{className:"admin-content",children:[e.jsx("div",{className:"traffic-toolbar",children:e.jsx("div",{className:"toolbar-top",children:e.jsx("div",{className:"title",children:"Content"})})}),e.jsx(V,{cards:6,type:"content"})]}):m?e.jsxs("div",{style:{padding:"2rem",color:"#b91c1c"},children:["Error: ",m]}):e.jsxs("div",{className:"admin-content",children:[e.jsxs("div",{className:"traffic-toolbar",children:[e.jsxs("div",{className:"toolbar-top",children:[e.jsx("div",{className:"title",children:"Content"}),e.jsx("button",{className:"add-content-btn",onClick:()=>d(!0),title:"Add Content",children:e.jsx(he,{size:20})})]}),e.jsxs("div",{className:"traffic-chip-row",children:[e.jsx("button",{className:"traffic-chip",type:"button",children:"All Posts"}),e.jsx("button",{className:"traffic-chip",type:"button",children:"Drafts"}),e.jsx("button",{className:"traffic-chip",type:"button",children:"Categories"})]})]}),e.jsx("div",{className:"card-grid",children:i.map(j=>e.jsxs("div",{className:"content-card",children:[e.jsx("div",{className:"content-title",children:j.title}),e.jsx("div",{className:"content-excerpt",children:j.excerpt}),e.jsxs("div",{className:"row-actions",children:[e.jsx("button",{className:"btn small",onClick:()=>N(j),children:"Edit"}),e.jsx("button",{className:"btn small",children:"Publish"}),e.jsx("button",{className:"btn small danger",onClick:()=>M(j.id),children:"Delete"})]})]},j.id))}),a&&e.jsx(Ne,{onSave:y,onCancel:g,initialPost:x})]})}const Se=({count:a=6})=>{const d={backgroundColor:"#f0f0f0",borderRadius:"8px",animation:"pulse 1.5s ease-in-out infinite"};return e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, minmax(0, 1fr))",gap:16,padding:16},children:Array.from({length:a}).map((i,c)=>e.jsxs("div",{style:{position:"relative",background:"#ffffff",border:"1px solid #e1e5e9",borderRadius:14,padding:0,overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",left:0,top:0,bottom:0,width:4,background:"#000000"}}),e.jsxs("div",{style:{padding:"14px 16px 14px 20px",display:"flex",alignItems:"center",gap:14},children:[e.jsx("div",{style:{width:52,height:52,minWidth:52,borderRadius:12,backgroundColor:"#f0f0f0",animation:"pulse 1.5s ease-in-out infinite"}}),e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:8},children:[e.jsx("div",{style:{...d,height:"16px",width:"60%"}}),e.jsx("div",{style:{...d,height:"14px",width:"40%"}})]}),e.jsx("div",{style:{...d,height:"20px",width:"60px",borderRadius:"12px"}})]})]},c))})};function F(a){const d=new Date(a),c=new Date-d,x=Math.floor(c/(1e3*60)),p=Math.floor(c/(1e3*60*60)),s=Math.floor(c/(1e3*60*60*24));return x<1?"Just now":x<60?`${x}m ago`:p<24?`${p}h ago`:s<7?`${s}d ago`:d.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}const U={instagram:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24","aria-hidden":!0,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"ig-small-sessions",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#f58529"}),e.jsx("stop",{offset:"50%",stopColor:"#dd2a7b"}),e.jsx("stop",{offset:"100%",stopColor:"#8134af"})]})}),e.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"5",fill:"url(#ig-small-sessions)"}),e.jsx("circle",{cx:"12",cy:"12",r:"4.5",fill:"none",stroke:"#fff",strokeWidth:"2"}),e.jsx("circle",{cx:"17",cy:"7",r:"1.3",fill:"#fff"})]}),facebook:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24","aria-hidden":!0,children:[e.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2",fill:"#1877f2"}),e.jsx("path",{d:"M16 8h-2c-.5 0-1 .5-1 1v2h3l-.5 3h-2.5v7h-3v-7H8v-3h2V9c0-2 1.5-4 4-4h2v3z",fill:"#fff"})]}),youtube:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24","aria-hidden":!0,children:[e.jsx("rect",{x:"2",y:"6",width:"20",height:"12",rx:"3",fill:"#ff0000"}),e.jsx("polygon",{points:"10,9 16,12 10,15",fill:"#ffffff"})]}),google:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24","aria-hidden":!0,children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),other:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24","aria-hidden":!0,children:[e.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#666"}),e.jsx("path",{d:"M2 12h20M12 2v20",stroke:"#fff",strokeWidth:"1.5",opacity:"0.6"}),e.jsx("circle",{cx:"12",cy:"12",r:"5",fill:"none",stroke:"#fff",strokeWidth:"1.5",opacity:"0.9"})]})};function Ce(){const[a,d]=r.useState(!0),[i,c]=r.useState(""),[x,p]=r.useState([]),[s,k]=r.useState(0),[m,u]=r.useState(""),[h,y]=r.useState(""),[N,g]=r.useState(""),[M,j]=r.useState(!0),[t,v]=r.useState(null),[l,R]=r.useState(null),[W,P]=r.useState([]),[f,b]=r.useState(!1);async function C(n=0){try{d(!0);const o={};m&&(o.source=m),h&&(o.user_id=h),N&&(o.visitor_id=N),o.limit="50",o.offset=String(n*50);const{data:A}=await S.get(H(w.admin.sessions,o));p(Array.isArray(A.sessions)?A.sessions:[]),k(n),c("")}catch(o){c(z.getErrorMessage(o)),p([])}finally{d(!1)}}async function L(n){try{v(n),b(!0),R(null),P([]);const[o,A]=await Promise.all([S.get(w.admin.sessionById(n)),S.get(w.admin.sessionEvents(n))]);R(o.data.session||null),P(Array.isArray(A.data.events)?A.data.events:[])}catch(o){c(z.getErrorMessage(o))}}if(r.useEffect(()=>{C(0)},[]),r.useEffect(()=>{C(0)},[m]),a)return e.jsxs("div",{className:"admin-traffic",children:[e.jsx("div",{className:"traffic-toolbar",children:e.jsx("div",{className:"toolbar-top",children:e.jsx("div",{className:"title",children:"Sessions"})})}),e.jsx(Se,{count:8})]});if(i)return e.jsxs("div",{style:{padding:16,color:"#b91c1c"},children:["Error: ",i]});const _=n=>n.ended_at||Date.now()-new Date(n.last_seen_at).getTime()>1800*1e3;return e.jsxs("div",{className:"admin-traffic",children:[e.jsx("div",{className:"traffic-toolbar",children:e.jsx("div",{className:"toolbar-top",children:e.jsx("div",{className:"title",children:"Sessions"})})}),e.jsxs("div",{className:"traffic-table-wrap",style:{display:"grid",gridTemplateColumns:M?"1fr 300px":"1fr",gap:12,alignItems:"start",marginTop:16},children:[e.jsx("div",{className:"table-card",style:{background:"transparent",border:"none"},children:e.jsxs("div",{style:{padding:16},children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, minmax(0, 1fr))",gap:16},children:x.map(n=>e.jsxs("button",{onClick:()=>L(n.session_id),style:{position:"relative",textAlign:"left",background:"#ffffff",borderRadius:14,padding:0,display:"flex",flexDirection:"column",cursor:"pointer",overflow:"hidden",transition:"all 0.2s ease",borderColor:"#e1e5e9"},onMouseEnter:o=>{o.currentTarget.style.transform="translateY(-2px)",o.currentTarget.style.borderColor="#000000"},onMouseLeave:o=>{o.currentTarget.style.transform="translateY(0)",o.currentTarget.style.borderColor="#e1e5e9"},children:[e.jsx("div",{style:{position:"absolute",left:0,top:0,bottom:0,width:4,background:"#000000"}}),e.jsxs("div",{style:{padding:"14px 16px 14px 20px",display:"flex",alignItems:"center",gap:14},children:[e.jsxs("div",{style:{width:52,height:52,minWidth:52,borderRadius:12,display:"flex",alignItems:"center",justifyContent:"center",background:"#f8f9fa",border:"2px solid #e5e7eb",position:"relative"},children:[U[n.visitor_source||"other"]||U.other,e.jsx("div",{style:{position:"absolute",bottom:-6,left:"50%",transform:"translateX(-50%)",background:"#111",color:"#fff",fontSize:9,fontWeight:300,padding:"2px 6px",borderRadius:4,whiteSpace:"nowrap",border:"1.5px solid #fff"},children:n.visitor_source||"other"})]}),e.jsxs("div",{style:{flex:1,display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"#666",fontWeight:300,marginBottom:3},children:"Started"}),e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"#111"},children:F(n.started_at)})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"#666",fontWeight:300,marginBottom:3},children:"Last Seen"}),e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"#111"},children:F(n.last_seen_at)})]}),e.jsxs("div",{style:{gridColumn:"1 / -1",display:"flex",alignItems:"center",gap:6,marginTop:4},children:[e.jsxs("div",{style:{background:"#f3f4f6",padding:"4px 10px",borderRadius:6,display:"inline-flex",alignItems:"center",gap:4},children:[e.jsx("span",{style:{fontSize:11,color:"#666",fontWeight:300},children:"Source"}),e.jsx("span",{style:{fontSize:12,fontWeight:300,color:"#111"},children:n.source||"other"})]}),e.jsxs("div",{style:{background:"#f3f4f6",padding:"4px 10px",borderRadius:6,display:"inline-flex",alignItems:"center",gap:4},children:[e.jsx("span",{style:{fontSize:11,color:"#666",fontWeight:300},children:"Pages"}),e.jsx("span",{style:{fontSize:12,fontWeight:300,color:"#111"},children:n.page_count})]})]})]}),e.jsx("div",{style:{display:"flex",alignItems:"center"},children:e.jsx("span",{style:{fontSize:11,fontWeight:600,padding:"6px 12px",borderRadius:6,border:"2px solid",borderColor:_(n)?"#e5e7eb":"#86efac",color:_(n)?"#6b7280":"#166534",background:_(n)?"#f9fafb":"#dcfce7",minWidth:70,textAlign:"center"},children:_(n)?"Ended":"Active"})})]})]},n.session_id))}),e.jsxs("div",{className:"pagination-controls",style:{marginTop:12},children:[e.jsx("button",{className:"btn pagination-btn",onClick:()=>{s>0&&C(s-1)},disabled:s===0,style:{opacity:s===0?.5:1},children:"Previous"}),e.jsx("button",{className:"btn pagination-btn",onClick:()=>C(s+1),children:"Next"})]})]})}),M&&e.jsxs("aside",{className:"filters-card",children:[e.jsx("div",{className:"filters-header",children:"Filters"}),e.jsxs("div",{className:"filters-body",children:[e.jsxs("label",{className:"field",children:[e.jsx("div",{className:"label",children:"Source"}),e.jsxs("select",{value:m,onChange:n=>u(n.target.value),children:[e.jsx("option",{value:"",children:"All sources"}),e.jsx("option",{value:"instagram",children:"Instagram"}),e.jsx("option",{value:"facebook",children:"Facebook"}),e.jsx("option",{value:"youtube",children:"YouTube"}),e.jsx("option",{value:"google",children:"Google"}),e.jsx("option",{value:"other",children:"Others"})]})]}),e.jsxs("label",{className:"field",children:[e.jsx("div",{className:"label",children:"User ID"}),e.jsx("input",{value:h,onChange:n=>y(n.target.value),placeholder:"UUID"})]}),e.jsxs("label",{className:"field",children:[e.jsx("div",{className:"label",children:"Visitor ID"}),e.jsx("input",{value:N,onChange:n=>g(n.target.value),placeholder:"UUID"})]}),e.jsxs("div",{className:"filter-buttons",children:[e.jsx("button",{className:"btn primary",onClick:()=>C(0),children:"Apply"}),e.jsx("button",{className:"btn",onClick:()=>{u(""),y(""),g(""),C(0)},children:"Reset"})]})]})]})]}),f&&t&&e.jsx("div",{className:"modal-overlay",onClick:()=>b(!1),children:e.jsxs("div",{className:"modal-content session-details-modal",onClick:n=>n.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("div",{style:{width:42,height:42,borderRadius:10,background:"linear-gradient(135deg, var(--accent) 0%, var(--accent-dark) 100%)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(9, 105, 218, 0.25)"},children:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"3"}),e.jsx("path",{d:"M12 1v6m0 6v6M5.6 5.6l4.2 4.2m4.2 4.2l4.2 4.2M1 12h6m6 0h6M5.6 18.4l4.2-4.2m4.2-4.2l4.2-4.2"})]})}),e.jsxs("div",{children:[e.jsx("h2",{className:"modal-title",style:{marginBottom:2},children:"Session Details"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)",fontWeight:500},children:"Complete session analytics & tracking data"})]})]}),e.jsx("button",{className:"modal-close",onClick:()=>b(!1),children:"×"})]}),e.jsx("div",{className:"modal-body",children:l?e.jsxs("div",{className:"session-details-content",children:[e.jsxs("div",{className:"session-status-banner",children:[e.jsxs("div",{className:"status-sources",children:[e.jsxs("div",{className:"source-item",children:[e.jsx("div",{className:"source-icon",children:U[l.visitor_source||"other"]||U.other}),e.jsxs("div",{className:"source-info",children:[e.jsx("div",{className:"source-label",children:"Visitor Source"}),e.jsx("div",{className:"source-value",children:l.visitor_source||"other"})]})]}),e.jsx("div",{className:"source-arrow",children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M5 12h14M12 5l7 7-7 7"})})}),e.jsxs("div",{className:"source-item",children:[e.jsx("div",{className:"source-icon",children:U[l.source||"other"]||U.other}),e.jsxs("div",{className:"source-info",children:[e.jsx("div",{className:"source-label",children:"Session Source"}),e.jsx("div",{className:"source-value",children:l.source||"other"})]})]})]}),e.jsx("div",{className:"status-badge-container",children:e.jsxs("span",{className:`status-badge ${l.ended_at||Date.now()-new Date(l.last_seen_at).getTime()>1800*1e3?"ended":"active"}`,children:[e.jsx("span",{className:"status-dot"}),l.ended_at||Date.now()-new Date(l.last_seen_at).getTime()>1800*1e3?"Ended":"Active"]})})]}),e.jsxs("div",{className:"session-metrics-grid",children:[e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-icon",style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)"},children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12 6 12 12 16 14"})]})}),e.jsxs("div",{className:"metric-info",children:[e.jsx("div",{className:"metric-label",children:"Started"}),e.jsx("div",{className:"metric-value",children:F(l.started_at)}),e.jsx("div",{className:"metric-subtitle",children:new Date(l.started_at).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-icon",style:{background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)"},children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})})}),e.jsxs("div",{className:"metric-info",children:[e.jsx("div",{className:"metric-label",children:"Last Seen"}),e.jsx("div",{className:"metric-value",children:F(l.last_seen_at)}),e.jsx("div",{className:"metric-subtitle",children:new Date(l.last_seen_at).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-icon",style:{background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)"},children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("line",{x1:"12",y1:"18",x2:"12",y2:"12"}),e.jsx("line",{x1:"9",y1:"15",x2:"15",y2:"15"})]})}),e.jsxs("div",{className:"metric-info",children:[e.jsx("div",{className:"metric-label",children:"Pages Viewed"}),e.jsx("div",{className:"metric-value",children:l.page_count}),e.jsx("div",{className:"metric-subtitle",children:l.page_count===1?"Single page":"Multiple pages"})]})]})]}),e.jsxs("div",{className:"info-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),"Session Information"]}),e.jsxs("div",{className:"info-grid",children:[e.jsxs("div",{className:"info-item",children:[e.jsx("div",{className:"info-label",children:"Session ID"}),e.jsx("div",{className:"info-value info-code",children:l.id})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("div",{className:"info-label",children:"Visitor ID"}),e.jsx("div",{className:"info-value info-code",children:l.visitor_id})]}),e.jsxs("div",{className:"info-item full-width",children:[e.jsx("div",{className:"info-label",children:"User"}),e.jsx("div",{className:"info-value",children:l.user_id?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[e.jsx("img",{src:l.user_avatar||`https://ui-avatars.com/api/?name=${encodeURIComponent(l.user_name||l.user_email||"User")}&background=0969da&color=fff&size=40`,alt:l.user_name||l.user_email,style:{width:40,height:40,borderRadius:"50%",objectFit:"cover",border:"2px solid #e5e7eb"}}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"#111",marginBottom:2},children:l.user_name||l.user_email}),l.user_name&&l.user_email&&e.jsx("div",{style:{fontSize:12,color:"#666"},children:l.user_email})]})]}):e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[e.jsx("div",{style:{width:40,height:40,borderRadius:"50%",background:"#f3f4f6",border:"2px solid #e5e7eb",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#9ca3af",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),e.jsx("span",{style:{color:"var(--text-muted)",fontStyle:"italic",fontSize:14},children:"Guest User"})]})})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("div",{className:"info-label",children:"Landing Path"}),e.jsx("div",{className:"info-value info-path",children:l.landing_path||"/"})]}),l.referrer!==void 0&&e.jsxs("div",{className:"info-item full-width",children:[e.jsx("div",{className:"info-label",children:"Referrer"}),e.jsx("div",{className:"info-value info-url",children:l.referrer||e.jsx("span",{style:{color:"var(--text-muted)",fontStyle:"italic"},children:"Direct traffic"})})]})]})]}),e.jsxs("div",{className:"info-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2",ry:"2"}),e.jsx("line",{x1:"8",y1:"21",x2:"16",y2:"21"}),e.jsx("line",{x1:"12",y1:"17",x2:"12",y2:"21"})]}),"Technical Details"]}),e.jsxs("div",{className:"info-grid",children:[l.ip&&e.jsxs("div",{className:"info-item",children:[e.jsx("div",{className:"info-label",children:"IP Address"}),e.jsx("div",{className:"info-value info-code",children:l.ip})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("div",{className:"info-label",children:"Session Ended"}),e.jsx("div",{className:"info-value",children:l.ended_at||Date.now()-new Date(l.last_seen_at).getTime()>1800*1e3?l.ended_at?new Date(l.ended_at).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Ended (inferred)":e.jsx("span",{style:{color:"#10b981",fontWeight:600},children:"Active Session"})})]}),l.user_agent&&e.jsxs("div",{className:"info-item full-width",children:[e.jsx("div",{className:"info-label",children:"User Agent"}),e.jsx("div",{className:"info-value info-small",children:l.user_agent})]})]})]}),e.jsxs("div",{className:"info-section events-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"22 12 18 12 15 21 9 3 6 12 2 12"})}),"Session Events Timeline",e.jsxs("span",{className:"event-count",children:[W.length," ",W.length===1?"event":"events"]})]}),W.length>0?e.jsx("div",{className:"events-timeline",children:W.map((n,o)=>e.jsxs("div",{className:"event-item",children:[e.jsxs("div",{className:"event-marker",children:[e.jsx("div",{className:"event-dot"}),o!==W.length-1&&e.jsx("div",{className:"event-line"})]}),e.jsxs("div",{className:"event-content",children:[e.jsxs("div",{className:"event-header",children:[e.jsx("div",{className:"event-time",children:F(n.occurred_at)}),e.jsx("div",{className:"event-time-full",children:new Date(n.occurred_at).toLocaleString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"})})]}),e.jsxs("div",{className:"event-path",children:[e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"})]}),n.path||"/"]}),n.referrer&&e.jsxs("div",{className:"event-referrer",children:[e.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),e.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]}),"from ",n.referrer]})]})]},o))}):e.jsxs("div",{className:"empty-state",children:[e.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),e.jsx("div",{className:"empty-title",children:"No Events Recorded"}),e.jsx("div",{className:"empty-description",children:"This session doesn't have any tracked events yet."})]})]})]}):e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("div",{style:{marginTop:12,fontSize:14,color:"var(--text-muted)"},children:"Loading session details..."})]})})]})})]})}function ze(){const[a,d]=r.useState(null),[i,c]=r.useState(!1),x=Y(),p=K();r.useEffect(()=>{let u=!1;async function h(){try{const{data:y}=await S.get(w.admin.dashboard);u||d(y.user)}catch(y){if(q.isAuthError(y)){window.location.href="/not-accessible";return}}}return h(),()=>{u=!0}},[]);const s=r.useMemo(()=>[{key:"overview",label:"Overview",icon:xe,path:"/admin/overview"},{key:"sessions",label:"Sessions",icon:me,path:"/admin/sessions"},{key:"users",label:"Users",icon:O,path:"/admin/users"},{key:"content",label:"Content",icon:ue,path:"/admin/content"},{key:"settings",label:"Settings",icon:fe,path:"/admin/settings"}],[]),k=p.pathname,m=s.find(u=>u.path===k)?.key||"overview";return e.jsxs("div",{style:{display:"flex",minHeight:"calc(100vh - 64px)",background:"#ebebeb",position:"relative"},children:[e.jsx("button",{onClick:()=>c(!i),style:{position:"fixed",top:80,left:16,zIndex:1e3,background:"#000",border:"1px solid #333",borderRadius:8,padding:"0.5rem",cursor:"pointer",display:"none",color:"#fff"},className:"mobile-menu-btn",children:i?e.jsx(pe,{size:20}):e.jsx(ge,{size:20})}),i&&e.jsx("div",{onClick:()=>c(!1),style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:998,display:"none"},className:"sidebar-overlay"}),e.jsxs("aside",{style:{width:260,borderRight:"1px solid #111",background:"#000",position:"fixed",height:"calc(100vh - 64px)",paddingTop:60,zIndex:999,transition:"transform 0.3s ease"},className:`admin-sidebar ${i?"sidebar-open":""}`,children:[e.jsxs("div",{style:{padding:"1rem 1rem 0.5rem 1rem"},children:[e.jsx("div",{style:{fontSize:18,fontWeight:800,color:"#fff"},children:"Admin"}),e.jsx("div",{style:{fontSize:12,color:"#bbb"},children:"Signed in as"}),e.jsx("div",{style:{fontSize:13,color:"#ddd",wordBreak:"break-all"},children:a?.email})]}),e.jsx("div",{style:{padding:"0.75rem 0.5rem"},children:s.map(u=>e.jsxs("button",{onClick:()=>{x(u.path),c(!1)},style:{width:"100%",display:"flex",alignItems:"center",gap:10,padding:"0.6rem 0.75rem",background:m===u.key?"#fff":"transparent",color:m===u.key?"#111":"#ddd",border:"1px solid "+(m===u.key?"#fff":"#333"),borderRadius:8,margin:"0.25rem 0",cursor:"pointer",textAlign:"left"},children:[e.jsx(u.icon,{size:16,style:{color:m===u.key?"#111":"#ddd"}}),e.jsx("span",{style:{fontWeight:700,fontSize:14},children:u.label})]},u.key))})]}),e.jsx("section",{style:{flex:1,padding:"1.25rem",marginLeft:260},className:"admin-main-content",children:e.jsxs(X,{children:[e.jsx(B,{index:!0,element:e.jsx(J,{to:"/admin/overview",replace:!0})}),e.jsx(B,{path:"overview",element:e.jsx(ve,{})}),e.jsx(B,{path:"sessions",element:e.jsx(Ce,{})}),e.jsx(B,{path:"users",element:e.jsx(ke,{})}),e.jsx(B,{path:"content",element:e.jsx(we,{})}),e.jsx(B,{path:"settings",element:e.jsx(je,{})})]})}),e.jsx("style",{children:`
        @media (max-width: 768px) {
          .mobile-menu-btn {
            display: block !important;
          }
          .sidebar-overlay {
            display: block !important;
          }
          .admin-sidebar {
            transform: translateX(-100%);
          }
          .admin-sidebar.sidebar-open {
            transform: translateX(0);
          }
          .admin-main-content {
            margin-left: 0 !important;
          }
        }
        @media (min-width: 769px) {
          .admin-sidebar {
            position: fixed !important;
            transform: translateX(0) !important;
          }
        }
      `})]})}export{ze as default};
